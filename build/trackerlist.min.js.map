{"version":3,"sources":["../src/trackerlist.js"],"names":["define","$","cfg","log","moodletrackerlist","init","bind","load_change_form","submit_change_form","solve_issue","quick_find","debug","that","waiter","wwwroot","html","id","attr","replace","mode","ctx","url","get","data","selectpicker","issueid","purpose","val","result","oldclassname","get_status_code","oldvalue","removeClass","newclassname","newvalue","addClass","newlabel","modal","statusix","cmid","sesskey","window","location","submit"],"mappings":"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","sourcesContent":["\n/*eslint-disable no-unused-vars */\n\ndefine(['jquery', 'core/config', 'core/log', 'mod_tracker/bootstrap-select'], function($, cfg, log, bootstrapselect) {\n\n    var moodletrackerlist = {\n\n        init: function() {\n\n            $(\".tracker-issue-edit-handle\").bind('click', this.load_change_form);\n            $(\"#modal-status-save\").bind('click', this.submit_change_form);\n            $(\".tracker-quick-solve-buttons\").bind('click', this.solve_issue);\n            $('#tracker-quick-find-input').bind('change', this.quick_find);\n            log.debug('AMD Tracker List initialized');\n        },\n\n        load_change_form: function() {\n            var that = $(this);\n\n            var waiter = '<div class=\"centered\"><center><img id=\"detail-waiter\" src=\"';\n            waiter += cfg.wwwroot + '/pix/i/ajaxloader.gif\" /></center></div>';\n            $('#issuelist-edit-inner-form').html(waiter);\n\n            var id = that.attr('id').replace(/issue-edit-(.*?)-handle-/, '');\n            var mode = that.attr('data-mode');\n            var ctx = that.attr('data-context');\n\n            var url = cfg.wwwroot + '/mod/tracker/ajax/service.php';\n            url += '?what=getmodalform';\n            url += '&mode=' + mode;\n            url += '&id=' + id;\n            url += '&ctx=' + ctx;\n\n            $.get(url, function(data) {\n                $('#issuelist-edit-inner-form').html(data);\n                $(\"#modal-status-save\").attr('data-issue', id);\n                $(\"#modal-status-save\").attr('data-purpose', mode);\n                $('.selectpicker').selectpicker();\n            }, 'html');\n        },\n\n        submit_change_form: function() {\n            var that = $(this);\n\n            var issueid = that.attr('data-issue');\n            var purpose = that.attr('data-purpose');\n            var url = cfg.wwwroot + '/mod/tracker/ajax/service.php';\n            url += '?what=update' + purpose;\n            url += '&id=' + issueid;\n            var selectkey = '#' + purpose + '-select-' + issueid;\n            url += '&' + purpose + '=' + $(selectkey).val();\n\n            $.get(url, function(data) {\n                if (data.result === 'success') {\n                    if (purpose == 'status') {\n                        var oldclassname = 'status-' + moodletrackerlist.get_status_code(data.oldvalue);\n                        $('.issue-list-status-' + issueid).removeClass(oldclassname);\n                        var newclassname = 'status-' + moodletrackerlist.get_status_code(data.newvalue);\n                        $('.issue-list-status-' + issueid).addClass(newclassname);\n                    }\n                    $('#tracker-' + purpose + '-' + issueid).html(data.newlabel);\n                    $('#issuelist-edit-form').modal('hide'); // Close the modal dialog.\n                }\n            }, 'json');\n        },\n\n        get_status_code: function (statusix) {\n            var statuscodes = ['posted',\n                'open',\n                'resolving',\n                'waiting',\n                'resolved',\n                'abandonned',\n                'transfered',\n                'testing',\n                'validated',\n                'published'\n            ];\n\n            return statuscodes[statusix];\n        },\n\n        solve_issue: function() {\n            var that = $(this);\n\n            var issueid = that.attr('id').replace('resolve-', '');\n            var cmid = that.attr('data-cmid');\n            var url = cfg.wwwroot + '/mod/tracker/view.php?id=' + cmid;\n            url += '&view=view';\n            url += '&screen=mytickets';\n            url += '&what=solve';\n            url += '&issueid=' + issueid;\n            url += '&sesskey=' + cfg.sesskey;\n            window.location = url;\n        },\n\n        quick_find: function() {\n            $('#id-quick-find-form').submit();\n        }\n\n    };\n\n    return moodletrackerlist;\n});"],"file":"trackerlist.min.js"}