{"version":3,"file":"trackerlist.min.js","sources":["../src/trackerlist.js"],"sourcesContent":["\n/*eslint-disable no-unused-vars */\n\ndefine(['jquery', 'core/config', 'core/log', 'mod_tracker/bootstrap-select'], function($, cfg, log, bootstrapselect) {\n\n    var moodletrackerlist = {\n\n        init: function() {\n\n            $(\".tracker-issue-edit-handle\").bind('click', this.load_change_form);\n            $(\"#modal-status-save\").bind('click', this.submit_change_form);\n            $(\".tracker-quick-solve-buttons\").bind('click', this.solve_issue);\n            $('#tracker-quick-find-input').bind('change', this.quick_find);\n            log.debug('AMD Tracker List initialized');\n        },\n\n        load_change_form: function() {\n            var that = $(this);\n\n            var waiter = '<div class=\"centered\"><center><img id=\"detail-waiter\" src=\"';\n            waiter += cfg.wwwroot + '/pix/i/ajaxloader.gif\" /></center></div>';\n            $('#issuelist-edit-inner-form').html(waiter);\n\n            var id = that.attr('id').replace(/issue-edit-(.*?)-handle-/, '');\n            var mode = that.attr('data-mode');\n            var ctx = that.attr('data-context');\n\n            var url = cfg.wwwroot + '/mod/tracker/ajax/service.php';\n            url += '?what=getmodalform';\n            url += '&mode=' + mode;\n            url += '&id=' + id;\n            url += '&ctx=' + ctx;\n\n            $.get(url, function(data) {\n                $('#issuelist-edit-inner-form').html(data);\n                $(\"#modal-status-save\").attr('data-issue', id);\n                $(\"#modal-status-save\").attr('data-purpose', mode);\n                $('.selectpicker').selectpicker();\n            }, 'html');\n        },\n\n        submit_change_form: function() {\n            var that = $(this);\n\n            var issueid = that.attr('data-issue');\n            var purpose = that.attr('data-purpose');\n            var url = cfg.wwwroot + '/mod/tracker/ajax/service.php';\n            url += '?what=update' + purpose;\n            url += '&id=' + issueid;\n            var selectkey = '#' + purpose + '-select-' + issueid;\n            url += '&' + purpose + '=' + $(selectkey).val();\n\n            $.get(url, function(data) {\n                if (data.result === 'success') {\n                    if (purpose == 'status') {\n                        var oldclassname = 'status-' + moodletrackerlist.get_status_code(data.oldvalue);\n                        $('.issue-list-status-' + issueid).removeClass(oldclassname);\n                        var newclassname = 'status-' + moodletrackerlist.get_status_code(data.newvalue);\n                        $('.issue-list-status-' + issueid).addClass(newclassname);\n                    }\n                    $('#tracker-' + purpose + '-' + issueid).html(data.newlabel);\n                    $('#issuelist-edit-form').modal('hide'); // Close the modal dialog.\n                }\n            }, 'json');\n        },\n\n        get_status_code: function (statusix) {\n            var statuscodes = ['posted',\n                'open',\n                'resolving',\n                'waiting',\n                'resolved',\n                'abandonned',\n                'transfered',\n                'testing',\n                'validated',\n                'published'\n            ];\n\n            return statuscodes[statusix];\n        },\n\n        solve_issue: function() {\n            var that = $(this);\n\n            var issueid = that.attr('id').replace('resolve-', '');\n            var cmid = that.attr('data-cmid');\n            var url = cfg.wwwroot + '/mod/tracker/view.php?id=' + cmid;\n            url += '&view=view';\n            url += '&screen=mytickets';\n            url += '&what=solve';\n            url += '&issueid=' + issueid;\n            url += '&sesskey=' + cfg.sesskey;\n            window.location = url;\n        },\n\n        quick_find: function() {\n            $('#id-quick-find-form').submit();\n        }\n\n    };\n\n    return moodletrackerlist;\n});"],"names":["define","$","cfg","log","bootstrapselect","moodletrackerlist","init","bind","this","load_change_form","submit_change_form","solve_issue","quick_find","debug","that","waiter","wwwroot","html","id","attr","replace","mode","ctx","url","get","data","selectpicker","issueid","purpose","val","result","oldclassname","get_status_code","oldvalue","removeClass","newclassname","newvalue","addClass","newlabel","modal","statusix","cmid","sesskey","window","location","submit"],"mappings":"AAGAA,iCAAO,CAAC,SAAU,cAAe,WAAY,iCAAiC,SAASC,EAAGC,IAAKC,IAAKC,iBAEhG,IAAIC,kBAAoB,CAEpBC,KAAM,WAEFL,EAAE,8BAA8BM,KAAK,QAASC,KAAKC,kBACnDR,EAAE,sBAAsBM,KAAK,QAASC,KAAKE,oBAC3CT,EAAE,gCAAgCM,KAAK,QAASC,KAAKG,aACrDV,EAAE,6BAA6BM,KAAK,SAAUC,KAAKI,YACnDT,IAAIU,MAAM,+BACb,EAEDJ,iBAAkB,WACd,IAAIK,KAAOb,EAAEO,MAETO,OAAS,8DACbA,QAAUb,IAAIc,QAAU,2CACxBf,EAAE,8BAA8BgB,KAAKF,QAErC,IAAIG,GAAKJ,KAAKK,KAAK,MAAMC,QAAQ,2BAA4B,IACzDC,KAAOP,KAAKK,KAAK,aACjBG,IAAMR,KAAKK,KAAK,gBAEhBI,IAAMrB,IAAIc,QAAU,gCACxBO,KAAO,qBACPA,KAAO,SAAWF,KAClBE,KAAO,OAASL,GAChBK,KAAO,QAAUD,IAEjBrB,EAAEuB,IAAID,KAAK,SAASE,MAChBxB,EAAE,8BAA8BgB,KAAKQ,MACrCxB,EAAE,sBAAsBkB,KAAK,aAAcD,IAC3CjB,EAAE,sBAAsBkB,KAAK,eAAgBE,MAC7CpB,EAAE,iBAAiByB,cACtB,GAAE,OACN,EAEDhB,mBAAoB,WAChB,IAAII,KAAOb,EAAEO,MAETmB,QAAUb,KAAKK,KAAK,cACpBS,QAAUd,KAAKK,KAAK,gBACpBI,IAAMrB,IAAIc,QAAU,gCACxBO,KAAO,eAAiBK,QACxBL,KAAO,OAASI,QAEhBJ,KAAO,IAAMK,QAAU,IAAM3B,EADb,IAAM2B,QAAU,WAAaD,SACHE,MAE1C5B,EAAEuB,IAAID,KAAK,SAASE,MAChB,GAAoB,YAAhBA,KAAKK,OAAsB,CAC3B,GAAe,UAAXF,QAAqB,CACrB,IAAIG,aAAe,UAAY1B,kBAAkB2B,gBAAgBP,KAAKQ,UACtEhC,EAAE,sBAAwB0B,SAASO,YAAYH,cAC/C,IAAII,aAAe,UAAY9B,kBAAkB2B,gBAAgBP,KAAKW,UACtEnC,EAAE,sBAAwB0B,SAASU,SAASF,aAChD,CACAlC,EAAE,YAAc2B,QAAU,IAAMD,SAASV,KAAKQ,KAAKa,UACnDrC,EAAE,wBAAwBsC,MAAM,OACpC,CACH,GAAE,OACN,EAEDP,gBAAiB,SAAUQ,UAavB,MAZkB,CAAC,SACf,OACA,YACA,UACA,WACA,aACA,aACA,UACA,YACA,aAGeA,SACtB,EAED7B,YAAa,WACT,IAAIG,KAAOb,EAAEO,MAETmB,QAAUb,KAAKK,KAAK,MAAMC,QAAQ,WAAY,IAC9CqB,KAAO3B,KAAKK,KAAK,aACjBI,IAAMrB,IAAIc,QAAU,4BAA8ByB,KACtDlB,KAAO,aACPA,KAAO,oBACPA,KAAO,cACPA,KAAO,YAAcI,QACrBJ,KAAO,YAAcrB,IAAIwC,QACzBC,OAAOC,SAAWrB,GACrB,EAEDX,WAAY,WACRX,EAAE,uBAAuB4C,QAC7B,GAIJ,OAAOxC,iBACX"}